---
permalink: protect-scsql/task_clone_from_a_sql_server_database_backup.html 
sidebar: sidebar 
keywords:  
summary: SnapCenter を使用して、 SQL Server データベースバックアップをクローニングすることができます。古いバージョンのデータにアクセスしたりリストアしたりする場合は、データベースバックアップをオンデマンドでクローニングできます。 
---
= SQL Server データベースバックアップからのクローニング
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
SnapCenter を使用して、 SQL Server データベースバックアップをクローニングすることができます。古いバージョンのデータにアクセスしたりリストアしたりする場合は、データベースバックアップをオンデマンドでクローニングできます。

* 必要なもの *

* データ保護の準備として、ホストの追加、リソースの特定、ストレージシステム接続の作成などのタスクを完了しておく必要があります。
* データベースまたはリソースグループをバックアップしておく必要があります。
* ログバックアップを使用した代替ホストへのクローニング中にセカンダリロケータを検出するには、データ LUN およびログ LUN のミラー、バックアップ、ミラー - ヴォールトなどの保護タイプを同じにする必要があります。
* SnapCenter のクローン処理中にマウントされたクローンドライブが見つからない場合は、 SnapCenter サーバの CloneRetryTimeout パラメータを 300 に変更する必要があります。
* ボリュームをホストするアグリゲートが Storage Virtual Machine （ SVM ）に割り当てられたアグリゲートリストに含まれていることを確認する必要があります。


* このタスクについて *

* スタンドアロンデータベースインスタンスにクローニングする際には、マウントポイントパスが存在し、専用ディスクであることを確認してください。
* フェイルオーバークラスタインスタンス（ FCI ）にクローニングする際は、マウントポイントが存在すること、共有ディスクであること、およびパスと FCI が同じ SQL リソースグループに属していることを確認してください。
* 各ホストに接続された vFC または FC イニシエータが 1 つだけであることを確認します。これは、 SnapCenter でサポートされるホストあたりのイニシエータの数が 1 つであるためです。
* ソースデータベースまたはターゲットインスタンスがクラスタ共有ボリューム（ CSV ）上にある場合、クローニングされたデータベースは CSV 上に作成されます。



NOTE: 仮想環境（ VMDK / RDM ）の場合は、マウントポイントが専用ディスクであることを確認します。

* 手順 *

. 左側のナビゲーションペインで、 [* リソース *] をクリックし、リストから [* SnapCenter Plug-in for SQL Server] を選択します。
. [ リソース ] ページで、 [ * 表示 ] リストから [ * データベース * ] または [ * リソースグループ * ] を選択します。
+

NOTE: インスタンスのバックアップのクローニングはサポートされていません。



* 手順 *

. データベースまたはリソースグループを選択します。
. Manage Copies （コピーの管理）ビューページから、プライマリまたはセカンダリ（ミラーまたはバックアップ）ストレージシステムからバックアップを選択します。
. バックアップを選択し、 * をクリックしますimage:../media/clone_icon.gif[""]*
. Clone Options ページで、次の操作を実行します。
+
|===
| フィールド | 手順 


 a| 
クローンサーバ
 a| 
クローンを作成するホストを選択します。



 a| 
インスタンスをクローニングします
 a| 
データベースバックアップのクローニング先となるクローンインスタンスを選択します。

指定したクローンサーバ上の SQL インスタンスを選択する必要があります。



 a| 
クローンのサフィックス
 a| 
クローンファイル名に付加される、データベースがクローンであることを示すサフィックスを入力します。

たとえば、 _db1_clone_.元のデータベースと同じ場所にクローニングする場合、クローニングされたデータベースを元のデータベースと区別するためにサフィックスを指定する必要があります。そうしないと、処理は失敗します。



 a| 
Auto assign mount point または Auto assign volume mount point under path
 a| 
マウントポイントを自動的に割り当てるか、パスを指定してボリュームマウントポイントを自動的に割り当てるかを選択します。

Auto assign volume mount point under path ：特定のディレクトリのパスを指定できます。指定したディレクトリにマウントポイントが作成されます。このオプションを選択する前に、ディレクトリが空であることを確認する必要があります。ディレクトリにデータベースが格納されている場合、そのデータベースはマウント処理後に無効な状態になります。

|===
. Logs ページで、次のいずれかのオプションを選択します。
+
|===
| フィールド | 手順 


 a| 
なし
 a| 
ログなしでフルバックアップのみをクローニングする場合は、このオプションを選択します。



 a| 
すべてのログバックアップ
 a| 
フルバックアップ後の日付のログバックアップをすべてクローニングする場合は、このオプションを選択します。



 a| 
までログバックアップでバックアップします
 a| 
選択した日付のバックアップログまでに作成されたバックアップログに基づいてデータベースをクローニングする場合、このオプションを選択します。



 a| 
期限までの特定の日付
 a| 
クローニングされたデータベースにトランザクションログを適用する最終日時を指定します。

ポイントインタイムのクローニングでは、指定した日時以降に記録されたトランザクションログエントリがクローニングされません。

|===
. スクリプトページで、クローニング処理の前後に実行するスクリプトのタイムアウト、パス、および引数をプリスクリプトまたはポストスクリプトで入力します。
+
たとえば、 SNMP トラップの更新、アラートの自動化、ログの送信などをスクリプトで実行できます。

+
デフォルトのスクリプトタイムアウトは 60 秒です。

. [ 通知 ] ページの [ 電子メールの設定 *] ドロップダウンリストから、電子メールを送信するシナリオを選択します。
+
また、送信者と受信者の E メールアドレス、および E メールの件名を指定する必要があります。実行したクローン処理のレポートを添付する場合は、 * ジョブレポートの添付 * を選択します。

+

NOTE: E メール通知を利用する場合は、 GUI または PowerShell コマンド Set-SmtpServer を使用して、 SMTP サーバの詳細を指定しておく必要があります。



EMS については、を参照してください https://docs.netapp.com/us-en/snapcenter/admin/concept_manage_ems_data_collection.html["EMS データ収集を管理します"]

. 概要を確認し、 [ 完了 ] をクリックします。
. 操作の進行状況を監視するには、 * Monitor * > * Jobs * をクリックします。


* 終了後 *

作成したクローンは、名前を変更しないでください。

* 詳細はこちら *

link:reference_back_up_sql_server_database_or_instance_or_availability_group.html["SQL Server データベース、インスタンス、または可用性グループをバックアップする"]

link:task_clone_backups_using_powershell_cmdlets_for_sql.html["PowerShell コマンドレットを使用してバックアップをクローニングする"]

https://kb.netapp.com/Advice_and_Troubleshooting/Data_Protection_and_Security/SnapCenter/Clone_operation_might_fail_or_take_longer_time_to_complete_with_default_TCP_TIMEOUT_value["デフォルトの TCP_TIMEOUT 値を使用すると、クローニング処理が失敗するか所要時間が長くなる可能性があります"]

https://kb.netapp.com/Advice_and_Troubleshooting/Data_Protection_and_Security/SnapCenter/The_failover_cluster_instance_database_clone_fails["フェイルオーバークラスタインスタンスのデータベースクローンが失敗します"]
