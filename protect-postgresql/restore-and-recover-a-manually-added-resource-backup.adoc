---
permalink: protect-postgresql/restore-and-recover-a-manually-added-resource-backup.html 
sidebar: sidebar 
keywords: SnapCenter Plug-in for postgresql 
summary: SnapCenter を使用して、 1 つ以上のバックアップからデータをリストアおよびリカバリできます。 
---
= 手動で追加したリソースバックアップをリストアおよびリカバリする
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
SnapCenter を使用して、 1 つ以上のバックアップからデータをリストアおよびリカバリできます。

.作業を開始する前に
* リソースまたはリソースグループをバックアップしておく必要があります。
* リストアするリソースまたはリソースグループに対して現在実行中のバックアップ処理がある場合は、すべてキャンセルしておく必要があります。
* リストア前、リストア後、マウント、アンマウントの各コマンドについて、プラグインホストのコマンドリストに以下のパスからコマンドが含まれていないか確認してください。
+
Windowsの場合：_C：\Program Files\NetApp\SnapCenter\Snapcenter Plug-in Creator\etc\allowed_commands.config_

+
Linuxの場合：_/var/opt/snapcenter/scc/allowed _ commands.config_

+

NOTE: コマンドリストにコマンドがない場合、処理は失敗します。



.このタスクについて
* ONTAP 9.12.1以前のバージョンでは、リストアの一環としてSnapLockヴォールトSnapshotから作成されたクローンにSnapLockヴォールトの有効期限が継承されます。SnapLockの有効期限が過ぎた時点で、ストレージ管理者がクローンを手動でクリーンアップする必要があります。


.手順
. 左側のナビゲーションペインで、 * リソース * をクリックし、リストから適切なプラグインを選択します。
. [ リソース ] ページで、リソースタイプに基づいて、 *View*] ドロップダウンリストからリソースをフィルタリングします。
+
リソースは、タイプ、ホスト、関連付けられているリソースグループとポリシー、およびステータスとともに表示されます。

+

NOTE: リストアの実行時は、バックアップがリストアグループのものであっても、リストア対象のリソースを個別に選択する必要があります。

+
リソースが保護されていない場合は ' 保護されていないというメッセージが [ 全体のステータス ] 列に表示されますこれは、リソースが保護されていないこと、またはリソースが別のユーザによってバックアップされていることを意味します。

. リソースを選択するか、リソースグループを選択してそのグループ内のリソースを選択します。
+
リソースのトポロジページが表示されます。

. Manage Copies （コピーの管理）ビューから、プライマリまたはセカンダリ（ミラーまたはバックアップ）ストレージシステムから * Backups （バックアップ）を選択します。
. [ プライマリ・バックアップ ] テーブルで、リストア元のバックアップを選択し、 [ * ] をクリックしますimage:../media/restore_icon.gif["リストアアイコン"]*
+
image::../media/restoring_resource.gif[リソースのリストア]

. [Restore Scope]ページで、*[Complete Resource]*を選択します。
+
.. [Complete Resource]*を選択すると、PostgreSQLクラスタのすべての設定済みデータボリュームが復元されます。
+
リソースにボリュームまたはqtreeが含まれている場合、そのボリュームまたはqtreeでリストア対象として選択されたSnapshotのあとに作成されたSnapshotは削除され、リカバリすることはできません。また、同じボリュームまたは qtree で他のリソースがホストされている場合、そのリソースも削除されます。

+
LUN は複数選択できます。



+

NOTE: 「 * all * 」を選択すると、ボリューム、 qtree 、または LUN 上のすべてのファイルがリストアされます。

. [ リストア前 ] ページで、リストア・ジョブを実行する前に実行するプリ・リストアおよびアンマウント・コマンドを入力します。
+
自動検出されたリソースにはアンマウントコマンドを使用できません。

. [ ポスト・オペレーション ] ページで、マウントおよびリストア後のコマンドを入力して、リストア・ジョブの実行後に実行します。
+
自動検出されたリソースに対しては、 mount コマンドを使用できません。

+

NOTE: 休止、Snapshot、および休止解除の処理を実行するプリコマンドとポストコマンドの場合は、Linuxの場合は_/opt/snapcenter/snapenter/scc/allowed commands.config_path、Windowsの場合は_C：\Program Files\NetApp\SnapCenter\Snapcenter Plug-in Creator\etc\allowed_commands.config_からプラグインホストで使用できるコマンドリストにコマンドが存在するかどうかを確認する必要があります。

. [ 通知 ] ページの [ 電子メールの設定 *] ドロップダウンリストから、電子メールを送信するシナリオを選択します。
+
また、送信者と受信者の E メールアドレスと E メールの件名を指定する必要があります。また、 [* 設定 * （ Settings * ） ] > [* グローバル設定 * （ * Global Settings * ） ] ページでも SMTP を設定する必要があります。

. 概要を確認し、 [ 完了 ] をクリックします。
. 操作の進行状況を監視するには、 * Monitor * > * Jobs * をクリックします。

