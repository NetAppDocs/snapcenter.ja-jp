---
permalink: protect-sco/task_clone_a_pluggable_database.html 
sidebar: sidebar 
keywords: clone, pluggable database, PDB 
summary: Pluggable Database \ （ PDB\ ）を、同じホストまたは代替ホスト上の異なるターゲット CDB または同じ CDB にクローニングできます。クローニングされたPDBを目的のSCNまたは日時にリカバリすることもできます。 
---
= プラガブルデータベースのクローニング
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
プラガブルデータベース（PDB）は、同じホストまたは代替ホスト上の別のターゲットCDBまたは同じターゲットCDBにクローニングできます。クローニングされたPDBを目的のSCNまたは日時にリカバリすることもできます。

* 始める前に *

root以外のユーザとしてプラグインをインストールした場合は、実行権限をプリスクリプトディレクトリとポストスクリプトディレクトリに手動で割り当てる必要があります。

* 手順 *

. 左側のナビゲーションペインで、 * リソース * をクリックし、リストから適切なプラグインを選択します。
. [ リソース ] ページで、 [ * 表示 ] リストから [ * データベース * ] または [ * リソースグループ * ] を選択します。
. データベースの詳細ビューまたはリソースグループの詳細ビューで、タイプが単一インスタンス（マルチテナント）のデータベースを選択します。
+
データベーストポロジページが表示されます。

. [コピーの管理]ビューで、ローカルコピー（プライマリ）、ミラーコピー（セカンダリ）、バックアップコピー（セカンダリ）のいずれかのバックアップを選択します。
. 表からバックアップを選択し、**をクリックしますimage:../media/clone_icon.gif["クローンアイコン"]。
. [ 名前 ] ページで、次の操作を実行します。
+
.. [*PDB Clone*] を選択します。
.. クローニングするPDBを指定します。
+

NOTE: 一度にクローニングできるPDBは1つだけです。

.. クローンPDBの名前を指定します。


. [ 場所 ] ページで、次の操作を実行します。
+
|===


| フィールド | 操作 


 a| 
クローンホスト
 a| 
デフォルトでは、ソースデータベースホストが入力されています。

別のホストにクローンを作成する場合は、ソースデータベースホストと同じバージョンのOracleおよびOSがインストールされているホストを選択します。



 a| 
ターゲット CDB
 a| 
クローンPDBを含めるCDBを選択します。

ターゲットCDBが実行されていることを確認する必要があります。



 a| 
データベースの状態
 a| 
PDB を読み取り / 書き込みモードで開く場合は、「 * クローン PDB を読み取り / 書き込みモードで開く」チェックボックスをオンにします。



 a| 
データファイルの場所
 a| 
デフォルトでは、データファイルの場所が入力されています。

SANファイルシステムまたはNFSファイルシステムのSnapCenterのデフォルトの命名規則は、FileSystemNameofsourcedatabase_SCJOBIDです。

SnapCenterディスクグループのデフォルトの命名規則は、SC_HASHCODEofDISKGROUP_SCJOBIDです。HASHCODEofDISKGROUPは、ASMディスクグループごとに一意の、自動的に生成される番号（2～10桁）です。


NOTE: ASMディスクグループ名をカスタマイズする場合は、名前の長さがOracleでサポートされる最大長に従っていることを確認してください。

別のパスを指定する場合は、クローンデータベースのデータファイルマウントポイントまたはASMディスクグループ名を入力する必要があります。

|===
+
Oracleホーム、ユーザ名、およびグループの詳細は、ソースデータベースから自動的に入力されます。値は、クローンを作成するホストのOracle環境に基づいて変更できます。

. PreOps ページで、次の手順を実行します。
+
.. クローニング処理の前に実行するプリスクリプトのパスと引数を入力します。
+
プリスクリプトは、/var/opt/snapcenter/spl/scriptsまたはこのパス内の任意のフォルダに保存してください。デフォルトでは、/var/opt/snapcenter/spl/scriptsパスが入力されています。スクリプトをこのパス内の任意のフォルダに配置した場合は、スクリプトを配置するフォルダまでの完全なパスを指定する必要があります。

+
SnapCenterでは、プリスクリプトとポストスクリプトの実行時に、事前定義された環境変数を使用できます。 link:../protect-sco/predefined-environment-variables-prescript-postscript-clone.html["詳細"^]

.. [Auxiliary CDB clone database parameter settings]セクションで、データベースの初期化に使用される事前入力されたデータベースパラメータの値を変更します。


. [*Reset] をクリックして、データベースパラメータのデフォルト設定を取得します。
. PostOps ページで、 * Until Cancel * がデフォルトで選択され、クローンデータベースのリカバリを実行します。
+
SnapCenter が適切なログ・バックアップを見つけられない場合は、 * Until Cancel * オプションは選択されません。外部アーカイブログの場所を指定する： * でログバックアップを使用できない場合は、外部アーカイブログの場所を指定します。 *ログの場所は複数指定できます。

+

NOTE: フラッシュリカバリ領域（FRA）とOracle Managed Files（OMF）をサポートするように設定されたソースデータベースをクローニングする場合は、リカバリのログデスティネーションもOMFディレクトリ構造に従う必要があります。

+
|===
| フィールド名 | 説明 


 a| 
キャンセルするまで
 a| 
SnapCenterは、クローニング対象として選択されたデータバックアップのあとに、破損していない一連のアーカイブログを含む最新のログバックアップをマウントすることでリカバリを実行します。

プライマリストレージでクローンを実行するには、ログとデータのバックアップをプライマリストレージに配置し、セカンダリストレージでクローンを実行するには、ログとデータのバックアップをセカンダリストレージに配置する必要があります。クローンデータベースは、欠落または破損したログファイルまでリカバリされます。



 a| 
日付と時刻
 a| 
SnapCenterは、指定された日時までデータベースをリカバリします。


NOTE: 時刻は24時間形式で指定できます。



 a| 
SCN（システム変更番号）まで
 a| 
SnapCenterは、指定されたシステム変更番号（SCN）までデータベースをリカバリします。



 a| 
外部アーカイブログの場所を指定
 a| 
外部アーカイブログの場所を指定します。



 a| 
新しいDBIDの作成
 a| 
デフォルトでは、補助クローンデータベースに対して新しい DBID * を作成チェック・ボックスは選択されません。

ソースデータベースと区別する補助クローンデータベースの一意の番号（DBID）を生成する場合は、このチェックボックスを選択します。



 a| 
一時表領域用の一時ファイルの作成
 a| 
クローンデータベースのデフォルトの一時表領域用の一時ファイルを作成する場合は、このチェックボックスを選択します。

このチェックボックスをオフにすると、一時ファイルなしでデータベースクローンが作成されます。



 a| 
クローンの作成時に適用するSQLエントリを入力してください
 a| 
クローン作成時に適用するSQLエントリを追加します。



 a| 
クローニング処理のあとに実行するスクリプトを入力してください
 a| 
クローニング処理のあとに実行するポストスクリプトのパスと引数を指定します。

PostScript は /var/opt/snapcenter /spl/scripts_or に保存するか、このパス内の任意のフォルダに保存する必要があります。

デフォルトでは、 /var/opt/snapcenter /spl/scripts_path が読み込まれます。スクリプトをこのパス内の任意のフォルダに配置した場合は、スクリプトを配置するフォルダまでの完全なパスを指定する必要があります。


NOTE: クローニング処理が失敗した場合、ポストスクリプトは実行されず、クリーンアップアクティビティが直接トリガーされます。

|===
. [ 通知 ] ページの [ 電子メールの設定 *] ドロップダウンリストから、電子メールを送信するシナリオを選択します。
+
また、送信者と受信者のEメールアドレス、およびEメールの件名を指定する必要があります。実行したクローン処理のレポートを添付する場合は、 * ジョブレポートの添付 * を選択します。

+

NOTE: Eメール通知を使用する場合は、GUIまたはPowerShellコマンドSet-SmSmSmtpServerを使用して、SMTPサーバの詳細を指定しておく必要があります。

. 概要を確認し、 [ 完了 ] をクリックします。
. 操作の進行状況を監視するには、 * Monitor * > * Jobs * をクリックします。


* 終了後 *

PDBのクローンのバックアップを作成する場合は、PDBのクローン先のCDBをバックアップする必要があります。これは、PDBのクローンのみをバックアップすることはできないためです。セカンダリ関係を使用してバックアップを作成する場合は、ターゲットCDBのセカンダリ関係を作成する必要があります。

RACセットアップでは、PDBクローンのストレージは、PDBクローンが実行されたノードにのみ接続されます。RACの他のノードのPDBがMOUNT状態です。クローニングされたPDBに他のノードからアクセスできるようにするには、ストレージを他のノードに手動で接続する必要があります。

* 詳細はこちら *

* https://kb.netapp.com/Advice_and_Troubleshooting/Data_Protection_and_Security/SnapCenter/ORA-00308%3A_cannot_open_archived_log_ORA_LOG_arch1_123_456789012.arc["リストアまたはクローニングが失敗して ORA-00308 エラーメッセージが表示されます"^]
* https://kb.netapp.com/Advice_and_Troubleshooting/Data_Protection_and_Security/SnapCenter/What_are_the_customizable_parameters_for_backup_restore_and_clone_operations_on_AIX_systems["AIX システムでのバックアップ、リストア、クローニングの各処理のパラメータをカスタマイズできます"^]

